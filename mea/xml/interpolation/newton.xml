<?xml version="1.0" encoding="UTF-8" ?>

<chapter xml:id="diffdivisees" xmlns:xi="http://www.w3.org/2001/XInclude">
<title>Forme de Newton</title>

<introduction>

  <interactive xml:id="interactive_forme_newton" platform="sage" width="100%" aspect="33:45">
    <slate surface="sage">
      @interact
      def _(x = input_box(label = html(r'Les \(x\)'), default = [1, 2, 3, 4], width = 30), y = input_box(label = html(r'Les \(y\)'), default = [-3, 7, 0, 5], width = 30)):
          n = len(x) - 1
          var('t')
          diffDiv = [y]
          for j in range(1,n+1):
              nouvelleColonne = []
              for i in range(0, n-j+1):
                  nouvelleDiffDiv = (diffDiv[j-1][i+1] - diffDiv[j-1][i]) / (x[i+j] - x[i])
                  nouvelleColonne.append(nouvelleDiffDiv)
              diffDiv.append(nouvelleColonne)
          N = diffDiv[0][0]
          a = x[0]
          b = x[0]
          P = [(x[0], y[0])]
          Nbase = [1]
          for j in range(1, n+1):
              if x[j-1] != 0:
                  Nj = Nbase[j-1] * (t - x[j-1])
              else:
                  Nj = Nbase[j-1] * t
              Nbase.append(Nj)
              N = N + diffDiv[j][0] * Nj
              P.append((x[j], y[j]))
              a = min(a, x[j])
              b = max(b, x[j])
          N(t) = N
          r = (b - a) / 20
          G = plot(N(t), (t, a-r, b+r), color = 'red', thickness = 1)
          G = G + points(P, color = 'green', pointsize = 50)
          G.show(figsize = 5, aspect_ratio = 'automatic')
          pretty_print(html(r'Forme de Newton du polynôme interpolateur :'))
          pretty_print(diffDiv[0][0])
          if diffDiv[1][0] &lt; 0:
              pretty_print(diffDiv[1][0], ' (', Nbase[1], ')')
          else:
              pretty_print('+ ', diffDiv[1][0], ' (', Nbase[1], ')')
          for j in range(2, n+1):
              if diffDiv[j][0] &lt; 0:
                  pretty_print(diffDiv[j][0], Nbase[j])
              else:
                  pretty_print('+ ', diffDiv[j][0], Nbase[j])
    </slate>
  </interactive>

</introduction>

<section xml:id="presentationdiffdiv">
<title>Présentation</title>

<p>
  Au chapitre <xref ref="lagrange"/>, on a vu comment calculer la forme de Lagrange
  <me>y_0\,L_0(t)+y_1\,L_1(t)+\cdots+y_n\,L_n(t)</me>
  du polynôme interpolateur de <m>n+1</m> points d'abscisses distinctes deux à deux
  <me>A_0=(x_0;y_0),\;A_1=(x_1;y_1),\;\ldots,\;A_n=(x_n;y_n)\;\in\mathbb{R}^2.</me>
  C'est une technique très simple d'un point de vue théorique, mais elle présente un inconvénient majeur : il faut refaire tous les calculs chaque fois qu'on ajoute un point à interpoler.
</p>
<p>
  Dans ce chapitre, nous nous intéressons à la forme de Newton du polynôme interpolateur
  <me>d_0+d_1\,N_1(t)+\cdots+d_n\,N_n(t)</me>
  où
  <me>N_i(t)=(t-x_0)(t-x_1)\cdots(t-x_{i-1})</me>
  est un polynôme de degré <m>i</m> pour <m>i=1,2,\ldots,n</m>.
</p>
<p>Comment calculer les coefficients <m>d_i</m>?</p>

<example xml:id="exemple1newton">
  <p>
    Déterminons la forme de Newton du polynôme interpolateur des trois points
    <me>A_0=(1;-3),\; A_1=(2;7)\;\text{et}\; A_2=(3;0).</me>
  </p>
  <p>
    On a
    <md>
      <mrow>N(t)&amp;=d_0+d_1\,N_1(t)+d_2\,N_2(t)</mrow>
      <mrow>&amp;=d_0+d_1(t-x_0)+d_2(t-x_0)(t-x_1)</mrow>
      <mrow>&amp;=d_0+d_1(t-1)+d_2(t-1)(t-2)</mrow>
    </md>
    et on cherche donc trois nombres réels <m>d_0,d_1,d_2</m> tels que
    <me>\begin{cases}N(1)=-3,\\N(2)=7,\\N(3)=0,\end{cases}</me>
    ce qui équivaut à résoudre le système triangulaire
    <me>
      \begin{cases}
      d_0&amp;&amp;&amp;&amp;&amp;=&amp;-3,\\
      d_0&amp;+&amp;d_1&amp;&amp;&amp;=&amp;7,\\
      d_0&amp;+&amp;2d_1&amp;+&amp;2d_2&amp;=&amp;0.\\
      \end{cases}
    </me>
  </p>
  <ul>
    <li>La première équation donne tout de suite <m>d_0=-3</m>.</li>
    <li>
      <p>
        La deuxième équation donne <m>d_0+d_1=7</m>, d'où
        <md>
          <mrow>-3+d_1&amp;=7,</mrow>
          <mrow>d_1&amp;=7+3=10.</mrow>
        </md>
      </p>
    </li>
    <li>
      <p>
        La troisième équation donne <m>d_0+2d_1+2d_2=0</m>, d'où
        <md>
          <mrow>-3+2\cdot 10+2d_2&amp;=0,</mrow>
          <mrow>2d_2&amp;=3-20=-17,</mrow>
          <mrow>d_2&amp;=-\frac{17}{2}.</mrow>
        </md>
      </p>
    </li>
  </ul>
  <p>
    La forme de Newton du polynôme interpolateur de ces trois points est donc
    <me>N(t)=-3+10(t-1)-\frac{17}{2}(t-1)(t-2).</me>
  </p>
  <p>
    Notons pour finir qu'il s'agit bien du même polynôme que celui déjà calculé aux exemples <xref ref="avantlagrange2"/> et <xref ref="aveclagrange2"/>.
    En effet, on a
    <md>
      <mrow>N(t)&amp;=-3+10(t-1)-\frac{17}{2}(t-1)(t-2)</mrow>
      <mrow>&amp;=-3+10(t-1)-\frac{17}{2}(t^2-3t+2)</mrow>
      <mrow>&amp;=-3+10t-10-\frac{17}{2}t^2+\frac{51}{2}t-17</mrow>
      <mrow>&amp;=-30+\frac{71}{2}t-\frac{17}{2}t^2.</mrow>
    </md>
  </p>
</example>

<p>Il existe un outil qui permet de calculer les coefficients <m>d_i</m> de la forme de Newton de manière systématique : les <url href="https://fr.wikipedia.org/wiki/Diff%C3%A9rences_divis%C3%A9es">différences divisées</url>.</p>

<definition>
  <title>Différences divisées</title>
  <p>
    Soit <m>n\geq 0</m> un entier et
    <me>A_0=(x_0;y_0),\; A_1=(x_1;y_1),\;\ldots,\; A_n=(x_n;y_n)\;\in\mathbb{R}^2</me>
    <m>n+1</m> points d'abscisses distinctes deux à deux.
  </p>
  <p>
    Voici comment on calcule les différences divisées associées à ces <m>n+1</m> points quand on sélectionne un, deux, trois, et, plus généralement, <m>k</m> points parmi ces derniers.
    <ul>
      <li>
        <p>
          Un point :
          <me>\left[A_i\right]=y_i</me>
          pour <m>0\leq i\leq n</m>.
        </p>
      </li>
      <li>
        <p>Deux points :
        <me>\left[A_{i_1},A_{i_2}\right]=\frac{\left[A_{i_2}\right]-\left[A_{i_1}\right]}{x_{i_2}-x_{i_1}}=\frac{y_{i_2}-y_{i_1}}{x_{i_2}-x_{i_1}}</me>
        pour <m>0\leq i_1&lt;i_2\leq n</m>.
        </p>
      </li>
      <li>
        <p>Trois points :
        <me>\left[A_{i_1},A_{i_2},A_{i_3}\right]=\frac{\left[A_{i_2},A_{i_3}\right]-\left[A_{i_1},A_{i_2}\right]}{x_{i_3}-x_{i_1}}=\frac{\frac{y_{i_3}-y_{i_2}}{x_{i_3}-x_{i_2}}-\frac{y_{i_2}-y_{i_1}}{x_{i_2}-x_{i_1}}}{x_{i_3}-x_{i_1}}</me>
        pour <m>0\leq i_1&lt;i_2&lt;i_3\leq n</m>.
        </p>
      </li>
      <li>
        <p><m>k</m> points :
        <me>\left[A_{i_1},\ldots,A_{i_k}\right]=\frac{\left[A_{i_2},\ldots,A_{i_k}\right]-\left[A_{i_1},\ldots,A_{i_{k-1}}\right]}{x_{i_k}-x_{i_1}}</me>
        pour <m>0\leq i_1&lt;\ldots&lt;i_k\leq n</m>.
        </p>
      </li>
    </ul>
  </p>
</definition>

<p>Notez que cette définition est récursive : pour calculer une différence divisée de <m>k</m> points, il faut déjà savoir le faire pour <m>k-1</m> points.</p>

<example xml:id="exemple1diffdiv">
  <p>Soit <m>A_0=(1;-3),\;A_1=(2;7)</m> et <m>A_2=(3;0)</m> les trois points de l'exemple <xref ref="exemple1newton"/>. Calculons les différences divisées suivantes :
    <me>\left[A_0\right],\;\left[A_0,A_1\right]\;\text{et}\;\left[A_0,A_1,A_2\right].</me>
  </p>
  <p>
    <ul>
      <li>
        <p>Pour le premier point :
          <me>\left[A_0\right]=y_0=-3.</me>
        </p>
      </li>
      <li>
        <p>Pour les deux premiers points :
          <md>
            <mrow>\left[A_0,A_1\right]&amp;=\frac{\left[A_1\right]-\left[A_0\right]}{x_1-x_0}</mrow>
            <mrow>&amp;=\frac{y_1-y_0}{x_1-x_0}</mrow>
            <mrow>&amp;=\frac{7-(-3)}{2-1}</mrow>
            <mrow>&amp;=10.</mrow>
          </md>
        </p>
      </li>
      <li>
        <p>Pour les trois points :
          <md>
            <mrow>\left[A_0,A_1,A_2\right]&amp;=\frac{\left[A_1,A_2\right]-\left[A_0,A_1\right]}{x_2-x_0}</mrow>
            <mrow>&amp;=\frac{\frac{y_2-y_1}{x_2-x_1}-\frac{y_1-y_0}{x_1-x_0}}{x_2-x_0}</mrow>
            <mrow>&amp;=\frac{\frac{0-7}{3-2}-\frac{7+3}{2-1}}{3-1}</mrow>
            <mrow>&amp;=\frac{-7-10}{2}</mrow>
            <mrow>&amp;=-\frac{17}{2}.</mrow>
          </md>
        </p>
      </li>
    </ul>
  </p>
  <p>
    Afin d'exploiter la nature récursive des différences divisées, on peut utiliser la présentation classique qui suit :
    <me>
      \begin{array}{c|ccc}
      x_i&amp;y_i=\left[A_i\right]&amp;\left[A_{i_1},A_{i_2}\right]&amp;\left[A_{i_1},A_{i_2},A_{i_3}\right]\\
      \hline\\
      1&amp;-3&amp;&amp;\\
      &amp;&amp;\frac{7-(-3)}{2-1}=10&amp;\\
      2&amp;7&amp;&amp;\frac{-7-10}{3-1}=-\frac{17}{2}\\
      &amp;&amp;\frac{0-7}{3-2}=-7&amp;\\
      3&amp;0&amp;&amp;
      \end{array}
    </me>
    i.e.
    <me>
      \begin{array}{c|ccc}
      x_i&amp;y_i&amp;&amp;\\
      \hline\\
      x_0=1&amp;\left[A_0\right]=-3&amp;&amp;\\
      &amp;&amp;\left[A_0,A_1\right]=10&amp;\\
      x_1=2&amp;\left[A_1\right]=7&amp;&amp;\left[A_0,A_1,A_2\right]=-\frac{17}{2}\\
      &amp;&amp;\left[A_1,A_2\right]=-7&amp;\\
      x_2=3&amp;\left[A_2\right]=0&amp;&amp;
      \end{array}
    </me>
  </p>
</example>

<remark>
  <p>
    Les trois différences divisées de l'exemple  <xref ref="exemple1diffdiv"/> correspondent aux trois coefficients de la forme de Newton calculés à l'exemple <xref ref="exemple1newton"/>, i.e.
    <me>d_0=\left[A_0\right],\; d_1=\left[A_0,A_1\right]\;\text{et}\; d_2=\left[A_0,A_1,A_2\right].</me>
  </p>
  <p>
    Autrement dit, la forme de Newton du polynôme interpolateur des trois points <m>A_0,A_1,A_2</m> est donnée par
    <me>N(t)=\left[A_0\right]+\left[A_0,A_1\right](t-1)+\left[A_0,A_1,A_2\right](t-1)(t-2).</me>
  </p>
  <p>Ce n'est pas un hasard, c'est toute la force de l'<url href="https://fr.wikipedia.org/wiki/Interpolation_newtonienne">interpolation newtonienne</url>.</p>
</remark>

<theorem xml:id="newtonavecdiffdiv">
  <title>Forme de Newton du polynôme interpolateur</title>
  <statement>
    <p>
      Soit <m>n\geq 0</m> un entier et
      <me>A_0=(x_0;y_0),\;A_1=(x_1;y_1),\;\ldots,\;A_n=(x_n;y_n)\;\in\mathbb{R}^2</me>
      <m>n+1</m> points d'abscisses distinctes deux à deux.
    </p>
    <p>
      Alors le polynôme interpolateur de ces points est donné par la formule
      <me>N(t):=\left[A_0\right]+\left[A_0,A_1\right](t-x_0)+\cdots+\left[A_0,\ldots,A_n\right](t-x_0)\cdots(t-x_{n-1}).</me>
    </p>
    <p>On appelle cela la <em>forme de Newton</em> du polynôme interpolateur.</p>
  </statement>
  <proof>
    <p>
      Notons <m>P(t)</m> le polynôme interpolateur de ces <m>n+1</m> points et <m>N(t)</m> le polynôme défini par la formule ci-dessus.
      Nous allons scinder cette preuve en deux étapes.
    </p>
    <ul>
      <li>Étape 1 : Montrer par récurrence sur <m>n</m> que le coefficient de degré <m>n</m> de <m>P(t)</m> est égal à la différence divisée <m>\left[A_0,\ldots,A_n\right]</m>.</li>
      <li>Étape 2 : Montrer par récurrence sur <m>n</m> que <m>P(t)=N(t)</m>.</li>
    </ul>
    <p>
      Commençons donc par l'étape 1.
      Pour un point (<m>n=0</m>), la propriété est triviale.
      Supposons-la donc vérifiée pour <m>n</m> points et notons alors <m>A(t)</m> le polynôme interpolateur des <m>n</m> premiers points <m>A_0,\ldots,A_{n-1}</m>, et <m>B(t)</m> le polynôme interpolateur des <m>n</m> derniers <m>A_1,\ldots,A_n</m>.
      Par unicité du polynôme interpolateur, on a
      <me>P(t)=\frac{(t-x_0)B(t)-(t-x_n)A(t)}{x_n-x_0},</me>
      puisque le terme de droite est un polynôme de degré <m>n</m> au plus valant <m>y_k</m> en <m>t=x_k</m> pour tout <m>0\le k\le n</m>.
      Par hypothèse de récurrence appliquée à <m>A(t)</m> et à <m>B(t)</m>, on en déduit que le coefficent de degré <m>n</m> dans <m>P(t)</m> vaut
      <me>\frac{\left[A_1,\ldots,A_n\right]-\left[A_0,\ldots,A_{n-1}\right]}{x_n-x_0},</me>
      i.e. <m>\left[A_0,\ldots,A_n\right]</m>, d'après la formule de récurrence définissant les différences divisées.
    </p>
    <p>
      Passons maintenant à l'étape 2.
      Pour un point (<m>n=0</m>), la propriété est à nouveau triviale.
      Supposons-la donc vérifiée pour <m>n</m> points et notons encore <m>A(t)</m> le polynôme interpolateur des <m>n</m> premiers points <m>A_0,\ldots,A_{n-1}</m>.
      Alors le polynôme <m>P(t)-A(t)</m> est de degré <m>n</m> au plus, et il s'annule au moins <m>n</m> fois, en <m>x_0,\ldots,x_{n-1}</m>.
      On a donc la factorisation
      <me>P(t)-A(t)=\lambda(t-x_0)\cdots(t-x_{n-1})</me>
      où, d'après l'étape 1, le coefficient <m>\lambda</m> et égal à <m>\left[A_0,\ldots,A_n\right]</m>.
      En appliquant enfin l'hypothèse de récurrence à <m>A(t)</m>, i.e. aux <m>n</m> premiers points <m>A_0,\ldots,A_{n-1}</m>, on obtient bien la formule <m>P(t)=N(t)</m> pour <m>n+1</m> points.
    </p>
  </proof>
</theorem>

<example xml:id="exemple2diffdiv">
  <p>
    Déterminons la forme de Newton <m>N(t)</m> du polynôme interpolateur des quatre points suivants :
    <me>A_0=(1;-3),\; A_1=(2;7),\; A_2=(3;0)\;\text{et}\; A_3=(4;5).</me>
  </p>
  <p>
    Nous devons calculer les différences divisées suivantes :
    <me>\left[A_0\right],\;\left[A_0,A_1\right],\;\left[A_0,A_1,A_2\right]\;\text{et}\;\left[A_0,A_1,A_2,A_3\right].</me>
  </p>
  <p>
    Présentons nos calculs dans un tableau :
    <me>
      \begin{array}{c|cccc}
      x_i&amp;y_i&amp;&amp;&amp;\\
      \hline\\
      1&amp;\left[A_0\right]=-3&amp;&amp;&amp;\\
      &amp;&amp;\left[A_0,A_1\right]=10&amp;&amp;\\
      2&amp;\left[A_1\right]=7&amp;&amp;\left[A_0,A_1,A_2\right]=-\frac{17}{2}&amp;\\
      &amp;&amp;\left[A_1,A_2\right]=-7&amp;&amp;\left[A_0,A_1,A_2,A_3\right]=\frac{29}{6}\\
      3&amp;\left[A_2\right]=0&amp;&amp;\left[A_1,A_2,A_3\right]=6&amp;\\
      &amp;&amp;\left[A_2,A_3\right]=5&amp;&amp;\\
      4&amp;\left[A_3\right]=5&amp;&amp;&amp;\\
      \end{array}
    </me>
  </p>
  <p>
    On a donc
    <me>N(t)=-3+10(t-1)-\frac{17}{2}(t-1)(t-2)+\frac{29}{6}(t-1)(t-2)(t-3).</me>
  </p>
</example>

<remark>
  <p>
    À l'exemple <xref ref="exemple2diffdiv"/>, on a ajouté le point <m>A_3=(4;5)</m> aux trois points <m>A_0=(1;-3),A_1=(2;7)</m> et <m>A_2=(3;0)</m> de l'exemple <xref ref="exemple1newton"/>.
    La forme de Newton du polynôme interpolateur est alors passée de
    <me>N(t)=-3+10(t-1)-\frac{17}{2}(t-1)(t-2)</me>
    à
    <me>N(t)=-3+10(t-1)-\frac{17}{2}(t-1)(t-2)+\frac{29}{6}(t-1)(t-2)(t-3).</me>
    Seul le coefficient <m>29/6</m> correspondant au terme de degré <m>3</m> s'est ajouté : à la différence de la forme de Lagrange, la forme de Newton permet d'ajouter un point à interpoler sans avoir à reprendre tous les calculs.
  </p>
</remark>

<remark xml:id="lagrangeEtNewtonTroisPoints">
  <p>
    Comparons la forme de Lagrange et la forme de Newton pour le polynôme interpolateur de trois points d'abscisses distinctes deux à deux
    <me>A_0=(x_0;y_0),\: A_1=(x_1;y_1)\;\text{et}\; A_2=(x_2;y_2).</me>
  </p>
  <p>
    Voici sa forme de Lagrange :
    <md>
      <mrow>L(t)&amp;=y_0\,L_0(t)+y_1\,L_1(t)+y_2\,L_2(t)</mrow>
      <mrow>&amp;=y_0\frac{(t-x_1)(t-x_2)}{(x_0-x_1)(x_0-x_2)}+y_1\frac{(t-x_0)(t-x_2)}{(x_1-x_0)(x_1-x_2)}+y_2\frac{(t-x_0)(t-x_1)}{(x_2-x_0)(x_2-x_1)}.</mrow>
    </md>
  </p>
  <p>
    Et voilà sa forme de Newton :
    <md>
      <mrow>N(t)&amp;=\left[A_0\right]+\left[A_0,A_1\right](t-x_0)+\left[A_0,A_1,A_2\right](t-x_0)(t-x_1)</mrow>
      <mrow>&amp;=y_0+\frac{y_1-y_0}{x_1-x_0}\cdot(t-x_0)+\frac{\frac{y_2-y_1}{x_2-x_1}-\frac{y_1-y_0}{x_1-x_0}}{x_2-x_0}\cdot(t-x_0)(t-x_1).</mrow>
    </md>
  </p>
  <p>
    Pour évaluer la forme de Lagrange écrite ainsi, on a besoin de <m>14</m> additions / soustractions et de <m>12</m> multiplications / divisions.
    Quant à la forme de Newton, elle requiert <m>13</m> additions / soustractions et <m>7</m> multiplications / divisions.
    C'est nettement mieux, et cela peut encore être amélioré en appliquant la méthode de Horner :
    <me>N(t)=y_0+(t-x_0)\cdot\left(\frac{y_1-y_0}{x_1-x_0}+\frac{\frac{y_2-y_1}{x_2-x_1}-\frac{y_1-y_0}{x_1-x_0}}{x_2-x_0}\cdot(t-x_1)\right).</me>
    On tombe alors à <m>12</m> additions / soustractions et <m>6</m> multiplications / divisions.
  </p>

</remark>

<assemblage>
  <title>Forme de Newton et différences divisées : Calculer efficacement un polynôme interpolateur</title>
  <p>
    <ul>
      <li>Objectif : Étant donné <m>n+1</m> points <m>A_0=(x_0;y_0),\ldots,A_n=(x_n;y_n)</m> d'abscisses distinctes deux à deux, déterminer le seul polynôme <m>N(t)</m> de degré <m>n</m> au plus qui passe par tous ces points.</li>
      <li>
        <p>
          Principe : Construire <m>N(t)</m> comme combinaison linéaire des polynômes
          <me>N_i(t):=(t-x_0)(t-x_1)\cdots(t-x_{i-1})</me>
          en posant
          <me>N(t):=d_0+d_1\,N_1(t)+\cdots+d_n\,N_n(t)</me>
          où le coefficient <m>d_i</m> est la différence divisée associée aux points <m>A_0=(x_0;y_0),\ldots,A_i=(x_i;y_i)</m>, c'est-à-dire
          <me>d_i=\left[A_0,\ldots,A_i\right]</me>
        </p>
      </li>
      <li>
        <p>
          Terminologie : On appelle <m>d_0+d_1\,N_1(t)+\cdots+d_n\,N_n(t)</m> la forme de Newton du polynôme interpolateur des points <m>A_0,A_1,\ldots,A_n</m>.
          Il s'agit du même polynôme que celui obtenu par interpolation de Lagrange, mais écrit différemment.
        </p>
      </li>
      <li>
        <p>Avantages :
          <ul>
            <li>À la différence de la forme de Lagrange, la forme de Newton permet d'ajouter un point d'interpolation sans avoir à reprendre tous les calculs.</li>
            <li>Grâce à la technique des différences divisées, le calcul de la forme de Newton nécessite moins d'opérations que celui de la forme de Lagrange.</li>
          </ul>
        </p>
      </li>
      <li>Voir aussi : <url href="https://drive.google.com/file/d/1ANZ409wB1DjcOVes1jWh2KRhu0FaUaad/view?usp=sharing">Notes de cours de Jérôme</url>.</li>
    </ul>
  </p>
</assemblage>

</section>

<section xml:id="algorithmediffdiv">
<title>Algorithme</title>

<algorithm>
  <title>Coefficients de la forme de Newton du polynôme interpolateur</title>
  <statement>
    <ul>
      <li>
        <p>
          Entrées :
          <ul>
            <li>Assigner à <m>\text{n}</m> le degré maximal du polynôme interpolateur.</li>
            <li>Assigner à <m>\text{x0},\text{x1},\ldots,\text{xn}</m> les abscisses des points à interpoler.</li>
            <li>Assigner à <m>\text{y0},\text{y1},\ldots,\text{yn}</m> les ordonnées des points à interpoler.</li>
          </ul>
        </p>
      </li>
      <li>
        <p>
          Instructions :
          <ul>
            <li>Assigner la liste <m>\text{y}</m> comme premier élément de la liste <m>\text{diffDiv}</m> qui contiendra toutes les différences divisées.</li>
            <li>
              <p>
                Pour <m>\text{j}</m> allant de <m>\text{1}</m> à <m>\text{n}</m>,
                <ul>
                  <li>initialiser <m>\text{nouvelleColonne}</m>, la liste qui contiendra toutes les différences divisées calculées à l'étape <m>j</m> : <m>\text{nouvelleColonne}=\left[\;\right]</m>;</li>
                  <li>
                    <p>
                      pour <m>\text{i}</m> allant de <m>\text{0}</m> à <m>\text{n-j}</m>,
                      <ul>
                        <li>
                          <p>
                            calculer la différence divisée <m>\left[A_i,A_{i+1},\ldots,A_{i+j}\right]</m> en utilisant la récursivité et l'assigner à <m>\text{nouvelleDiffDiv}</m> :
                            <me>\text{nouvelleDiffDiv} = \frac{\text{diffDiv}[j-1][i+1]-\text{diffDiv}[j-1][i]}{x[i+j]-x[i]};</me>
                          </p>
                        </li>
                        <li>ajouter la nouvelle différence divisée <m>\text{nouvelleDiffDiv}</m> à la liste <m>\text{nouvelleColonne}</m>;</li>
                      </ul>
                    </p>
                  </li>
                  <li>ajouter <m>\text{nouvelleColonne}</m> à la liste <m>\text{diffDiv}</m>.</li>
                </ul>
              </p>
            </li>
          </ul>
        </p>
      </li>
      <li>
        <p>
          Sortie : Pour <m>\text{j}</m> allant de <m>\text{0}</m> à <m>\text{n}</m>,
          <ul>
            <li>afficher <m>\text{diffDiv}[j][0]</m>.</li>
          </ul>
        </p>
      </li>
    </ul>
  </statement>
</algorithm>

<p>Voici une implémentation de cet algorithme qui permet de traiter l'exemple <xref ref="exemple1diffdiv"/>.</p>

<sage language='python'>
  <input>
    # entrées :
    n = 2
    x = [1.0, 2.0, 3.0]
    y = [-3.0, 7.0, 0.0]
    # instructions :
    diffDiv = [y]
    for j in range(1, n+1):
        nouvelleColonne = []
        for i in range(0, n-j+1):
            nouvelleDiffDiv = (diffDiv[j-1][i+1] - diffDiv[j-1][i]) / (x[i+j] - x[i])
            nouvelleColonne.append(nouvelleDiffDiv)
        diffDiv.append(nouvelleColonne)
    # sortie :
    for j in range(0, n+1):
        print(diffDiv[j][0])
  </input>
</sage>

</section>

<section xml:id="exercicesdiffdiv">
<title>Exercices</title>

<exercise>
  <statement>
    <p>
      On a commencé à remplir la table de différences divisées suivante :
      <me>
        \begin{array}{c|cccc}
        x_i&amp;y_i&amp;&amp;&amp;\\
        \hline\\
        -1&amp;5&amp;&amp;&amp;\\
        &amp;&amp;\frac{1}{2}&amp;&amp;\\
        3&amp;7&amp;&amp;&amp;\\
        &amp;&amp;-9&amp;&amp;\\
        4&amp;-2&amp;&amp;&amp;\\
        &amp;&amp;&amp;&amp;\\
        7&amp;4&amp;&amp;&amp;\\
        \end{array}
      </me>
      On note
      <me>A_0=(-1;5),\: A_1=(3;7),\; A_2=(4;-2)\;\text{et}\; A_3=(7;4).</me>
    </p>
    <p>
      <ol>
        <li>Combien vaut <m>\left[A_2\right]</m>?</li>
        <li>Combien vaut <m>\left[A_2,A_3\right]</m>?</li>
        <li>Combien vaut <m>\left[A_0,A_1,A_2\right]</m>?</li>
        <li>Complétez la table.</li>
      </ol>
    </p>
  </statement>
  <solution>
    <p>
      <ol>
        <li>On a <m>\left[A_2\right]=-2</m>.</li>
        <li>
          <p>
            On calcule
            <me>\left[A_2,A_3\right]=\frac{\left[A_3\right]-\left[A_2\right]}{x_3-x_2}=\frac{4+2}{7-4}=2.</me>
          </p>
        </li>
        <li>
          <p>
            On connait déjà
            <me>\left[A_0,A_1\right]=\frac{1}{2}\quad\text{et}\quad=\left[A_1,A_2\right]=-9.</me>
            On calcule alors
            <me>\displaystyle\left[A_0,A_1,A_2\right]=\frac{\left[A_1,A_2\right]-\left[A_0,A_1\right]}{x_2-x_0}=\frac{-9-\frac{1}{2}}{4+1}=-\frac{19}{10}.</me>
          </p>
        </li>
        <li>
          <p>
            On a
            <me>
              \begin{array}{c|cccc}
              x_i&amp;y_i&amp;&amp;&amp;\\
              \hline\\
              -1&amp;5&amp;&amp;&amp;\\
              &amp;&amp;\frac{1}{2}&amp;&amp;\\
              3&amp;7&amp;&amp;-\frac{19}{10}&amp;\\
              &amp;&amp;-9&amp;&amp;\frac{\frac{11}{4}+\frac{19}{10}}{7+1}=\frac{93}{160}\\
              4&amp;-2&amp;&amp;\frac{2+9}{7-3}=\frac{11}{4}&amp;\\
              &amp;&amp;2&amp;&amp;\\
              7&amp;4&amp;&amp;&amp;\\
              \end{array}
            </me>
          </p>
        </li>
      </ol>
    </p>
  </solution>
</exercise>

<exercise>
  <statement>
    <p>
      Soit <m>A,B</m> deux points d'abscisses distinctes.
      Il est facile de voir que
      <me>\left[A,B\right]=\left[B,A\right].</me>
    </p>
    <p>Plus généralement, les différences divisées ne dépendent pas de l'ordre des points : on dit qu'elles sont invariantes par permutation.</p>
    <p>
      Par exemple, vérifiez que
      <me>\left[A,B,C\right]=\left[C,A,B\right]</me>
      avec
      <me>A=(1;3),\; B=(3;-5)\;\text{et}\; C=(4;2).</me>
    </p>
  </statement>
  <solution>
    <p>
      Commençons par calculer <m>\left[A,B,C\right]</m> :
      <me>
        \begin{array}{c|ccc}
        x&amp;y\\
        \hline\\
        1&amp;\left[A\right]=3&amp;&amp;\\
        &amp;&amp;\left[A,B\right]=-4&amp;\\
        3&amp;\left[B\right]=-5&amp;&amp;\left[A,B,C\right]=\frac{11}{3}\\
        &amp;&amp;\left[B,C\right]=7&amp;\\
        4&amp;\left[C\right]=2&amp;&amp;
        \end{array}
      </me>
    </p>
    <p>
      Calculons ensuite <m>\left[C,A,B\right]</m> :
      <me>
        \begin{array}{c|ccc}
        x&amp;y\\
        \hline\\
        4&amp;\left[C\right]=2&amp;&amp;\\
        &amp;&amp;\left[C,A\right]=-\frac{1}{3}&amp;\\
        1&amp;\left[A\right]=3&amp;&amp;\left[C,A,B\right]=\frac{11}{3}\\
        &amp;&amp;\left[A,B\right]=-4&amp;\\
        3&amp;\left[B\right]=-5&amp;&amp;
        \end{array}
      </me>
    </p>
    <p>
      On a bien
      <me>\left[A,B,C\right]=\left[C,A,B\right]=\frac{11}{3}.</me>
    </p>
  </solution>
</exercise>

<exercise>
  <statement>
    <p>
      Déterminez la forme de Newton du polynôme interpolateur des trois points suivants :
      <me>A_0=(0;4),\;A_1=(2;-1)\;\text{et}\; A_2=(5;12).</me>
      <ol>
        <li>En résolvant un système linéaire.</li>
        <li>En utilisant les différences divisées.</li>
      </ol>
    </p>
  </statement>
  <solution>
    <ol>
      <li>
        <p>
          La forme de Newton du polynôme interpolateur de ces trois points s'écrit
          <md>
            <mrow>N(t)&amp;=d_0+d_1(t-x_0)+d_2(t-x_0)(t-x_1)</mrow>
            <mrow>&amp;=d_0+d_1t+d_2t(t-2).</mrow>
          </md>
        </p>
        <p>
          On cherche donc trois nombres réels <m>d_0,d_1,d_2</m> tels que
          <me>\begin{cases}N(0)=4,\\N(2)=-1,\\N(5)=12,\end{cases}</me>
          i.e.
          <me>
            \begin{cases}
            d_0&amp;&amp;&amp;&amp;&amp;=&amp;4,\\
            d_0&amp;+&amp;2d_1&amp;&amp;&amp;=&amp;-1,\\
            d_0&amp;+&amp;5d_1&amp;+&amp;15d_2&amp;=&amp;12.
            \end{cases}
          </me>
        </p>
        <p>
          Ce système linéaire est déjà triangulé.
          <ul>
            <li>La première équation donne <m>d_0=4</m>.</li>
            <li>
              <p>
                La deuxième équation donne <me>d_0+2d_1=-1</me>, d'où
                <md>
                  <mrow>4+2d_1&amp;=-1,</mrow>
                  <mrow>2d_1&amp;=-5,</mrow>
                  <mrow>d_1&amp;=-\frac{5}{2}.</mrow>
                </md>
              </p>
            </li>
            <li>
              <p>
                La troisième équation donne <me>d_0+5d_1+5d_2=0</me>, d'où
                <md>
                  <mrow>4-\frac{25}{2}+15d_2&amp;=12,</mrow>
                  <mrow>15d_2&amp;=12-4+\frac{25}{2}=\frac{41}{2},</mrow>
                  <mrow>d_2&amp;=\frac{41}{30}.</mrow>
                </md>
              </p>
            </li>
          </ul>
        </p>
        <p>
          La forme de Newton du polynôme interpolateur de ces trois points est donc
          <me>N(t)=4-\frac{5}{2}t+\frac{41}{30}t(t-2).</me>
        </p>
      </li>
      <li>
        <p>
          Calculons les différences divisées des trois points :
          <me>
            \begin{array}{c|ccc}
            x_i&amp;y_i\\
            \hline\\
            0&amp;\left[A_0\right]=4&amp;&amp;\\
            &amp;&amp;\left[A_0,A_1\right]=-\frac{5}{2}&amp;\\
            2&amp;\left[A_1\right]=-1&amp;&amp;\left[A_0,A_1,A_2\right]=\frac{41}{30}\\
            &amp;&amp;\left[A_1,A_2\right]=\frac{13}{3}&amp;\\
            5&amp;\left[A_2\right]=12&amp;&amp;
            \end{array}
          </me>
        </p>
        <p>On trouve donc les mêmes coefficients qu'à la question précédente.</p>
      </li>
    </ol>
  </solution>
</exercise>

<exercise xml:id="newtontroispointsalignes">
  <statement>
    <p>
      Déterminez la forme de Newton du polynôme interpolateur des trois points suivants :
      <me>A_0=(1;3),\; A_1=(2;6)\;\text{et}\; A_2=(3;9).</me>
      <ol>
        <li>En résolvant un système linéaire.</li>
        <li>En utilisant les différences divisées.</li>
      </ol>
    </p>
  </statement>
  <solution>
    <p>
      <ol>
        <li>
          <p>
            La forme de Newton du polynôme interpolateur de ces trois points s'écrit
            <md>
              <mrow>N(t)&amp;=d_0+d_1(t-x_0)+d_2(t-x_0)(t-x_1)</mrow>
              <mrow>&amp;=d_0+d_1(t-1)+d_2(t-1)(t-2).</mrow>
            </md>
          </p>
          <p>
            On cherche donc trois nombres réels <m>d_0,d_1,d_2</m> tels que
            <me>\begin{cases}N(1)=3,\\N(2)=6,\\N(3)=9\end{cases}</me>
            i.e.
            <me>
              \begin{cases}
              d_0&amp;&amp;&amp;&amp;&amp;=&amp;3,\\
              d_0&amp;+&amp;d_1&amp;&amp;&amp;=&amp;6,\\
              d_0&amp;+&amp;2d_1&amp;+&amp;2d_2&amp;=&amp;9.
              \end{cases}
            </me>
          </p>
          <p>
            Ce système linéaire est déjà triangulé.
            <ul>
              <li>La première équation donne <m>d_0=3</m>.</li>
              <li>
                <p>
                  La deuxième équation donne <m>d_0+d_1=6</m>, d'où
                  <md>
                    <mrow>3+d_1&amp;=6,</mrow>
                    <mrow>d_1&amp;=3.</mrow>
                  </md>
                </p>
              </li>
              <li>
                <p>
                  La troisième équation donne <m>d_0+2d_1+2d_2=0</m>, d'où
                  <md>
                    <mrow>3+6+2d_2&amp;=9,</mrow>
                    <mrow>2d_2&amp;=0,</mrow>
                    <mrow>d_2&amp;=0.</mrow>
                  </md>
                </p>
              </li>
            </ul>
          </p>
          <p>
            La forme de Newton du polynôme interpolateur de ces trois points est donc
            <me>N(t)=3+3(t-1)+0(t-1)(t-2)=3+3(t-1).</me>
          </p>
        </li>
        <li>
          <p>
            Calculons les différences divisées des trois points :
            <me>
              \begin{array}{c|ccc}
              x_i&amp;y_i\\
              \hline\\
              1&amp;\left[A_0\right]=3&amp;&amp;\\
              &amp;&amp;\left[A_0,A_1\right]=3&amp;\\
              2&amp;\left[A_1\right]=6&amp;&amp;\left[A_0,A_1,A_2\right]=0\\
              &amp;&amp;\left[A_1,A_2\right]=3&amp;\\
              3&amp;\left[A_2\right]=9&amp;&amp;
              \end{array}
            </me>
          </p>
          <p>On trouve donc les mêmes coefficients qu'à la question précédente.</p>
        </li>
      </ol>
    </p>
    <p>
      Remarque : En regardant les trois points à interpoler de plus près, on s'aperçoit qu'il sont alignés car ils appartiennent tous les trois à la droite d'équation
      <me>y=3x.</me>
      Leur polynôme interpolateur est donc le polynôme dont le graphe correspond à cette droite, c'est-à-dire
      <me>P(x)=3x.</me>
      Pour donner sa forme de Newton, il suffit d'effectuer la transformation algébrique suivante :
      <me>P(x)=3x-3+3=3(x-1)+3.</me>
    </p>
  </solution>
</exercise>

<exercise>
  <statement>
    <p>Ajoutez le point <m>A_3=(4;0)</m> aux points <m>A_0=(1;3),A_1=(2;6)</m> et <m>A_2=(3;9)</m> de l'exercice <xref ref="newtontroispointsalignes"/>.</p>
    <p>Déterminez la forme de Newton du polynôme interpolateur de ces quatre points en faisant le moins de calculs possible.</p>
  </statement>
  <solution>
    <p>
      La forme de Newton du polynôme interpolateur de ces quatre points s'écrit
      <md>
        <mrow>N(t)&amp;=d_0+d_1(t-x_0)+d_2(t-x_0)(t-x_1)+d_3(t-x_0)(t-x_1)(t-x_2)</mrow>
        <mrow>&amp;=d_0+d_1(t-1)+d_2(t-1)(t-2)+d_3(t-1)(t-2)(t-3).</mrow>
      </md>
    </p>
    <p>
      On cherche donc quatre nombres réels <m>d_0,d_1,d_2,d_3</m> tels que
      <me>\begin{cases}N(1)=3,\\N(2)=6,\\N(3)=9,\\N(4)=0,\end{cases}</me>
      i.e.
      <me>
        \begin{cases}
        d_0&amp;&amp;&amp;&amp;&amp;&amp;&amp;=&amp;3,\\
        d_0&amp;+&amp;d_1&amp;&amp;&amp;&amp;&amp;=&amp;6,\\
        d_0&amp;+&amp;2d_1&amp;+&amp;2d_2&amp;&amp;&amp;=&amp;9,\\
        d_0&amp;+&amp;3d_1&amp;+&amp;6d_2&amp;+&amp;6d_3&amp;=&amp;0.\\
        \end{cases}
      </me>
    </p>
    <p>
      Le système correspondant aux trois premières équations a déjà été résolu à l'exercice <xref ref="newtontroispointsalignes"/>, donc
      <me>d_0=3,\; d_1=3,\; d_2=0.</me>
    </p>
    <p>
      La quatrième équation donne <m>d_0+3d_1+6d_2+6d_3=0</m>, d'où
      <md>
        <mrow>3+9+0+6d_3&amp;=0,</mrow>
        <mrow>6d_3&amp;=-12,</mrow>
        <mrow>d_3&amp;=-2.</mrow>
      </md>
    </p>
    <p>
      La forme de Newton du polynôme interpolateur de ces quatre points est donc
      <me>N(t)=3+3(t-1)-2(t-1)(t-2)(t-3).</me>
    </p>
  </solution>
</exercise>

<exercise>
  <statement>
    <p>
      On s'intéresse au polynôme interpolateur des quatre points suivants :
      <me>A_0=(-2;0),\; A_1=(-1;3),\; A_2=(2;-1)\;\text{et}\; A_3=(3;7).</me>
    </p>
    <ol>
      <li>Donnez sa forme de Lagrange <m>L(t)</m>.</li>
      <li>Donnez sa forme de Newton <m>N(t)</m>.</li>
      <li>Vérifiez que ces deux formes correspondent bien au même polynôme, c'est-à-dire que <m>L(t)=N(t)</m>.</li>
    </ol>
  </statement>
  <solution>
    <ol>
      <li>
        <p>
          On a
          <md>
            <mrow>L(t)&amp;=y_0\,L_0(t)+y_1\,L_1(t)+y_2\,L_2(t)+y_3\,L_3(t)</mrow>
            <mrow>&amp;=0\,L_0(t)+3\,L_1(t)-L_2(t)+7\,L_3(t)</mrow>
            <mrow>&amp;=3\frac{(t+2)(t-2)(t-3)}{(-1+2)(-1-2)(-1-3)}-\frac{(t+2)(t+1)(t-3)}{(2+2)(2+1)(2-3)}</mrow>
            <mrow>&amp;\qquad +7\frac{(t+2)(t+1)(t-2)}{(3+2)(3+1)(3-2)}</mrow>
            <mrow>&amp;=\frac{1}{4}(t+2)(t-2)(t-3)+\frac{1}{12}(t+2)(t+1)(t-3)</mrow>
            <mrow>&amp;\qquad +\frac{7}{20}(t+2)(t+1)(t-2).</mrow>
          </md>
        </p>
      </li>
      <li>
        <p>
          Calculons les différences divisées de ces quatre points :
          <me>
            \begin{array}{c|cccc}
            x_i&amp;y_i&amp;&amp;&amp;\\
            \hline\\
            -2&amp;0&amp;&amp;&amp;\\
            &amp;&amp;3&amp;&amp;\\
            -1&amp;3&amp;&amp;-\frac{13}{12}&amp;\\
            &amp;&amp;-\frac{4}{3}&amp;&amp;\frac{41}{60}\\
            2&amp;-1&amp;&amp;\frac{28}{12}&amp;\\
            &amp;&amp;8&amp;&amp;\\
            3&amp;7&amp;&amp;&amp;\\
            \end{array}
          </me>
        </p>
        <p>
          La forme de Newton de leur polynôme interpolateur est donc
          <md>
            <mrow>N(t)&amp;=0+3(t+2)-\frac{13}{12}(t+2)(t+1)+\frac{41}{60}(t+2)(t+1)(t-2)</mrow>
            <mrow>&amp;=3(t+2)-\frac{13}{12}(t+2)(t+1)+\frac{41}{60}(t+2)(t+1)(t-2).</mrow>
          </md>
        </p>
      </li>
      <li>
        <p>
          C'est fastidieux.
          <url href="https://www.desmos.com/calculator/5py2k0qwww">Cliquez ici</url> pour une preuve visuelle avec Desmos.
        </p>
      </li>
    </ol>
  </solution>
</exercise>

<exercise>
  <statement>
    <p>
      Déterminez le polynôme interpolateur <m>P(t)</m> des points donnés en utilisant la technique des différences divisées :
      <ol>
        <li><m>(-2;3),(1;-3),(7;2)</m>;</li>
        <li><m>(-2;-2),(-1;2),(5;7)</m>;</li>
        <li><m>(1;3),(2;-3),(4;-5),(5;8)</m>;</li>
        <li><m>(-1;3),(4;7),(6;-3),(10;2)</m>.</li>
      </ol>
    </p>
  </statement>
  <solution>
    <p>
      <ol>
        <li>
          <p>
            Calculons les différences divisées des trois points :
            <me>
              \begin{array}{c|ccc}
              x_i&amp;y_i\\
              \hline\\
              -2&amp;3&amp;&amp;\\
              &amp;&amp;\frac{-3-3}{1+2}=-2&amp;\\
              1&amp;-3&amp;&amp;\frac{\frac{5}{6}+2}{7+2}=\frac{17}{54}\\
              &amp;&amp;\frac{2+3}{7-1}=\frac{5}{6}&amp;\\
              7&amp;2&amp;&amp;
              \end{array}
            </me>
            Donc
            <me>P(t)=3-2(t+2)+\frac{17}{54}(t+2)(t-1).</me>
          </p>
        </li>
        <li>
          <p>
            Calculons les différences divisées des trois points :
            <me>
              \begin{array}{c|ccc}
              x_i&amp;y_i\\
              \hline\\
              -2&amp;-2&amp;&amp;\\
              &amp;&amp;\frac{2+2}{-1+2}=4&amp;\\
              -1&amp;2&amp;&amp;\frac{\frac{5}{6}-4}{5+2}=-\frac{19}{42}\\
              &amp;&amp;\frac{7-2}{5+1}=\frac{5}{6}&amp;\\
              5&amp;7&amp;&amp;
              \end{array}
            </me>
            Donc
            <me>P(t)=-2+4(t+2)-\frac{19}{42}(t+2)(t+1).</me>
          </p>
        </li>
        <li>
          <p>
            Calculons les différences divisées de ces quatre points :
            <me>
              \begin{array}{c|cccc}
              x_i&amp;y_i&amp;&amp;&amp;\\
              \hline\\
              1&amp;3&amp;&amp;&amp;\\
              &amp;&amp;\frac{-3-3}{2-1}=-6&amp;&amp;\\
              2&amp;-3&amp;&amp;\frac{-1+6}{4-1}=\frac{5}{3}&amp;\\
              &amp;&amp;\frac{-5+3}{4-2}=-1&amp;&amp;\frac{\frac{14}{3}-\frac{5}{3}}{5-1}=\frac{3}{4}\\
              4&amp;-5&amp;&amp;\frac{13+1}{5-2}=\frac{14}{3}&amp;\\
              &amp;&amp;\frac{8+5}{5-4}=13&amp;&amp;\\
              5&amp;8&amp;&amp;&amp;\\
              \end{array}
            </me>
            Donc
            <me>P(t)=3-6(t-1)+\frac{5}{3}(t-1)(t-2)+\frac{3}{4}(t-1)(t-2)(t-4).</me>
          </p>
        </li>
        <li>
          <p>Calculons les différences divisées de ces quatre points :
            <me>
              \begin{array}{c|cccc}
              x_i&amp;y_i&amp;&amp;&amp;\\
              \hline\\
              -1&amp;3&amp;&amp;&amp;\\
              &amp;&amp;\frac{7-3}{4+1}=\frac{4}{5}&amp;&amp;\\
              4&amp;7&amp;&amp;\frac{-5-\frac{4}{5}}{6+1}=-\frac{29}{35}&amp;\\
              &amp;&amp;\frac{-3-7}{6-4}=-5&amp;&amp;\frac{\frac{25}{24}+\frac{29}{35}}{10+1}=\frac{1571}{9240}\\
              6&amp;-3&amp;&amp;\frac{\frac{5}{4}+5}{10-4}=\frac{25}{24}&amp;\\
              &amp;&amp;\frac{2+3}{10-6}=\frac{5}{4}&amp;&amp;\\
              10&amp;2&amp;&amp;&amp;\\
              \end{array}
            </me>
            Donc
            <me>P(t)=3+\frac{4}{5}(t+1)-\frac{29}{35}(t+1)(t-4)+\frac{1571}{9240}(t+1)(t-4)(t-6).</me>
          </p>
        </li>
      </ol>
    </p>
  </solution>
</exercise>

<exercise>
  <statement>
    <p>
      On a commencé à remplir la table de différences divisées suivante :
      <me>
        \begin{array}{c|cccc}
        x_i&amp;y_i&amp;&amp;&amp;\\
        \hline\\
        0{,}8&amp;0{,}717\,356&amp;&amp;&amp;\\
        &amp;&amp;0{,}579\,503&amp;&amp;\\
        1{,}1&amp;0{,}891\,207&amp;&amp;&amp;\\
        &amp;&amp;0{,}265\,720&amp;&amp;\\
        1{,}5&amp;0{,}997\,495&amp;&amp;&amp;\\
        &amp;&amp;-0{,}029\,150&amp;&amp;\\
        1{,}7&amp;0.991\,665&amp;&amp;&amp;\\
        \end{array}
      </me>
      On note
      <me>A_0=(0{,}8;0{,}717\,356),\quad A_1=(1{,}1;0{,}891\,207),</me>
      <me>A_2=(1{,}5;0{,}997\,495),\quad A_3=(1{,}7;0{,}991\,665).</me>
    </p>
    <p>Au besoin, tous les nombres seront arrondis à la sixième décimale.</p>
    <ol>
      <li>Complétez la table.</li>
      <li>Déterminez <m>P(t)</m> le polynôme interpolateur des points <m>A_0,A_1</m> et <m>A_2</m>.</li>
      <li>Déterminez <m>Q(t)</m> le polynôme interpolateur des points <m>A_1,A_2</m> et <m>A_3</m>.</li>
      <li>Sachant que les points de départ sont pris sur le graphe de la fonction <m>\sin(t)</m>, comparez les nombres <m>P(1{,3})</m> et <m>Q(1{,}3)</m> à la valeur dont ils sont une approximation.</li>
    </ol>
  </statement>
  <solution>
    <ol>
      <li>
        <p>
          On a
          <me>
            \begin{array}{c|cccc}
            x_i&amp;y_i&amp;&amp;&amp;\\
            \hline\\
            0{,}8&amp;0{,}717\,356&amp;&amp;&amp;\\
            &amp;&amp;0{,}579\,503&amp;&amp;\\
            1{,}1&amp;0{,}891\,207&amp;&amp;-0{,}448\,261&amp;\\
            &amp;&amp;0{,}265\,720&amp;&amp;-0{,}047\,988\\
            1{,}5&amp;0{,}997\,495&amp;&amp;-0{,}491\;450&amp;\\
            &amp;&amp;-0{,}029\,150&amp;&amp;\\
            1{,}7&amp;0{,}991\,665&amp;&amp;&amp;\\
            \end{array}
          </me>
        </p>
      </li>
      <li>
        <p>
          On déduit de la question 1 que
          <me>P(t)=0{,}717\,356+0{,}579\,503(t-0{,}8)-0{,}448\,261(t-0{,}8)(t-1{,}1).</me>
        </p>
      </li>
      <li>
        <p>
          On déduit de la question 1 que
          <me>Q(t)=0{,}891\,207+0{,}265\,720(t-1{,}1)-0{,}491\;450(t-1{,}1)(t-1{,}5).</me>
        </p>
      </li>
      <li>
        <p>
          D'une part, on a
          <md>
            <mrow>P(1{,}3)&amp;=0{,}717\,356+0{,}579\,503(1{,}3</mrow>
            <mrow>&amp;\qquad-0{,}8)-0{,}448\,261(1{,}3-0{,}8)(1{,}3-1{,}1)</mrow>
            <mrow>&amp;\approx 0{,}962\,281.</mrow>
          </md>
        </p>
        <p>
          D'autre part, on a
          <md>
            <mrow>Q(1{,}3)&amp;=0{,}891\,207+0{,}265\,720(1{,}3-1{,}1)</mrow>
            <mrow>&amp;\qquad-0{,}491\;450(1{,}3-1{,}1)(1{,}3-1{,}5)</mrow>
            <mrow>&amp;\approx 0{,}964\,009.</mrow>
          </md>
        </p>
        <p>
          Par ailleurs, on a
          <me>\sin(1{,}3)\approx 0{,}963\,558.</me>
        </p>
        <p>Donc <m>P(1{,}3)</m> constitue une approximation de <m>\sin(1{,}3)</m> qui lui est inférieure, tandis que <m>Q(1{,}3)</m> est une approximation supérieure.</p>
      </li>
    </ol>
  </solution>
</exercise>

<exercise>
  <statement>
    <p>
      Selon Statistique Canada, la quantité de cheddar (en grammes par personne par année) disponible au Canada a suivi l'évolution suivante de 2014 à 2018 :
      <me>
        \begin{array}{|c|c|}
        \hline
        \text{Année}&amp;\text{Cheddar disponible}\\
        \hline
        2014&amp;3310\\
        2015&amp;3220\\
        2016&amp;?\\
        2017&amp;3510\\
        2018&amp;4130\\
        \hline
        \end{array}
      </me>
    </p>
    <p>Malheureusement, il nous manque une donnée pour l'année 2016.</p>
    <ol>
      <li>Déterminez la forme de Newton du polynôme interpolateur des quatre points pour lesquels les données sont connues.</li>
      <li>Utilisez le polynôme interpolateur pour estimer la donnée manquante.</li>
    </ol>
  </statement>
  <solution>
    <ol>
      <li>
        <p>
          Voici la table des différences divisées :
          <me>
            \begin{array}{c|cccc}
            x_i&amp;y_i&amp;&amp;&amp;\\
            \hline\\
            2014&amp;3310&amp;&amp;&amp;\\
            &amp;&amp;-90&amp;&amp;\\
            2015&amp;3220&amp;&amp;\frac{235}{3}&amp;\\
            &amp;&amp;145&amp;&amp;20\\
            2017&amp;3510&amp;&amp;\frac{475}{3}&amp;\\
            &amp;&amp;620&amp;&amp;\\
            2018&amp;4130&amp;&amp;&amp;\\
            \end{array}
          </me>
        </p>
        <p>
          La forme de Newton du polynôme interpolateur est donc
          <md>
            <mrow>P(t)&amp;=3310-90(t-2014)+\frac{235}{3}(t-2014)(t-2015)</mrow>
            <mrow>&amp;\qquad +20(t-2014)(t-2015)(t-2017).</mrow>
          </md>
        </p>
      </li>
      <li>
        <p>
          On en déduit l'estimation suivante pour la donnée manquante :
          <md>
            <mrow>P(2016)&amp;=3310-90\cdot 2+\frac{235}{3}\cdot 2\cdot 1+20\cdot 2\cdot 1\cdot(-1)</mrow>
            <mrow>&amp;\approx 3247.</mrow>
          </md>
        </p>
      </li>
    </ol>
  </solution>
</exercise>

<exercise>
  <statement>
    <p>
      Voici les temps de course de Victor en fonction des distances sur lesquelles il a déjà été chronométré :
      <me>
        \begin{array}{|c|c|}
        \hline
        \text{Distance en mètres}&amp;\text{Temps en secondes}\\
        \hline
        1\,500&amp;362\\
        5\,000&amp;1275\\
        10\,000&amp;2674\\
        21\,097{,}5&amp;5577\\
        \hline
        \end{array}
      </me>
    </p>
    <p>Utilisez ces données pour prédire par interpolation polynomiale le temps qu'il mettra lors de la prochaine course de <m>15</m> kilomètres à laquelle il participera.</p>
  </statement>
  <solution>
    <p>
      En utilisant le code donné à la section <xref ref="algorithmediffdiv"/>, on obtient les différences divisées de ces quatre points et on en déduit la forme de Newton de son polynôme interpolateur :
      <md>
        <mrow>P(t)&amp;\approx 362</mrow>
        <mrow>&amp;\qquad+0{,}260857142857(t-1500)</mrow>
        <mrow>&amp;\qquad+2{,}22857142857\cdot 10^{-6}(t-1500)(t-5000)</mrow>
        <mrow>&amp;\qquad-1{,}71438966056\cdot 10^{-10}(t-1500)(t-5000)(t-10000).</mrow>
      </md>
    </p>
    <p>
      On calcule alors <m>P(15000)</m> et on trouve
      <me>P(15000)\approx 4216.</me>
    </p>
    <p>
      On estime ainsi que Victor mettra <m>4216</m> secondes, i.e.
      <me>1\,\text{heure}\;10\,\text{minutes}\;16\,\text{secondes}</me>
      environ pour courir son prochain <m>15</m> kilomètres.
    </p>
<!--
    <p>Étant donné que la dernière différence divisée est vraiment petite, on est tenté d'éliminer le premier point correspondant au <m>1500</m> mètres.
      Le polynôme interpolateur des trois points qui restent est alors
      <md>
        <mrow>Q(t)&amp;\approx 1275</mrow>
        <mrow>&amp;\qquad+0{,}2798(t-5000)</mrow>
        <mrow>&amp;\qquad-1{,}1312037087\cdot 10^{-6}(t-5000)(t-10000).</mrow>
      </md>
    </p>
    <p>Et on trouve
      <me>Q(15000)\approx 4230.</me>
    </p>
    <p>De cette façon, on estime que Victor mettra <m>4230</m> secondes environ, soit
      <me>1\,\text{heure}\;10\,\text{minutes}\;30\,\text{secondes}</me>
      pour courir son prochain <m>15</m> kilomètres.
    </p>
-->
  </solution>
</exercise>

<exercise>
  <statement>
    <p>Démontrez le théorème <xref ref="newtonavecdiffdiv"/> dans le cas <m>n=2</m>.</p>
  </statement>
  <solution>
    <p>
      Soit <m>A_0=(x_0;y_0),A_1=(x_1;y_1)</m> et <m>A_2=(x_2;y_2)</m> trois points d'abscisses distinctes deux à deux.
      La forme de Newton de leur polynôme annulateur s'écrit
      <me>N(t)=d_0+d_1(t-x_0)+d_2(t-x_0)(t-x_1).</me>
    </p>
    <p>
      On cherche donc trois nombres réels <m>d_0,d_1,d_2</m> tels que
      <me>\begin{cases}N(x_0)=y_0,\\N(x_1)=y_1,\\N(x_2)=y_2,\end{cases}</me>
      i.e.
      <me>
        \begin{cases}
        d_0&amp;=&amp;y_0,\\
        d_0+(x_1-x_0)d_1&amp;=&amp;y_1,\\
        d_0+(x_2-x_0)d_1+(x_2-x_0)(x_2-x_1)d_2&amp;=&amp;y_2.\\
        \end{cases}
      </me>
    </p>
    <p>
      Ce système linéaire est déjà triangulé.
      <ul>
        <li>La première équation donne <m>d_0=y_0</m>.</li>
        <li>
          <p>
            La deuxième équation donne <m>d_0+(x_1-x_0)d_1=y_1</m>, d'où
            <md>
              <mrow>y_0+(x_1-x_0)d_1&amp;=y_1,</mrow>
              <mrow>(x_1-x_0)d_1&amp;=y_1-y_0,</mrow>
              <mrow>d_1&amp;=\frac{y_1-y_0}{x_1-x_0}.</mrow>
            </md>
          </p>
        </li>
        <li>
          <p>
            La troisième équation donne <m>d_0+(x_2-x_0)d_1+(x_2-x_0)(x_2-x_1)d_2=y_2</m>, d'où
            <md>
              <mrow>&amp;y_0+(x_2-x_0)\frac{y_1-y_0}{x_1-x_0}+(x_2-x_0)(x_2-x_1)d_2=y_2,</mrow>
              <mrow>&amp;(x_2-x_0)(x_2-x_1)d_2=y_2-y_0-(x_2-x_0)\frac{y_1-y_0}{x_1-x_0},</mrow>
              <mrow>&amp;(x_2-x_0)(x_2-x_1)d_2=y_2-y_1+y_1-y_0-(x_2-x_0)\frac{y_1-y_0}{x_1-x_0},</mrow>
              <mrow>&amp;(x_2-x_0)(x_2-x_1)d_2=y_2-y_1+\left(x_1-x_0-(x_2-x_0)\right)\frac{y_1-y_0}{x_1-x_0},</mrow>
              <mrow>&amp;(x_2-x_0)(x_2-x_1)d_2=y_2-y_1+\left(x_1-x_2\right)\frac{y_1-y_0}{x_1-x_0},</mrow>
              <mrow>&amp;d_2=\frac{y_2-y_1}{(x_2-x_0)(x_2-x_1)}+\left(x_1-x_2\right)\frac{y_1-y_0}{(x_1-x_0)(x_2-x_0)(x_2-x_1)},</mrow>
              <mrow>&amp;d_2=\frac{y_2-y_1}{(x_2-x_0)(x_2-x_1)}-\frac{y_1-y_0}{(x_1-x_0)(x_2-x_0)},</mrow>
              <mrow>&amp;d_2=\frac{\frac{y_2-y_1}{x_2-x_1}-\frac{y_1-y_0}{x_1-x_0} }{x_2-x_0}.</mrow>
            </md>
          </p>
        </li>
      </ul>
    </p>
    <p>
      La forme de Newton du polynôme interpolateur de ces trois points est donc
      <me>N(t)=y_0+\frac{y_1-y_0}{x_1-x_0}(t-x_0)+\frac{\frac{y_2-y_1}{x_2-x_1}-\frac{y_1-y_0}{x_1-x_0} }{x_2-x_0}(t-x_0)(t-x_1),</me>
      i.e.
      <me>N(t)=\left[A_0\right]+\left[A_0,A_1\right](t-x_0)+\left[A_0,A_1,A_2\right](t-x_0)(t-x_1).</me>
    </p>
  </solution>
</exercise>

<exercise xml:id="formedenewton">
  <statement>
    <p>Modifiez le code donné à la section <xref ref="algorithmediffdiv"/> afin qu'il affiche la forme de Newton du polynôme interpolateur.</p>
    <p>
      Testez votre code avec l'exemple <xref ref="exemple2diffdiv"/> qui doit donner
      <me>N(t)=-3+10(t-1)-\frac{17}{2}(t-1)(t-2)+\frac{29}{6}(t-1)(t-2)(t-3),</me>
      i.e.
      <pre>4.833333333333333*(t - 1.0)*(t - 2.0)*(t - 3.0) - 8.5*(t - 1.0)*(t - 2.0) + 10.0*t - 13.0</pre>
    </p>
  </statement>
  <hint>
    <p>Il faut essentiellement ajouter une boucle permettant de calculer les polynômes de base <m>N_j(t)</m> à l'intérieur d'une boucle additionnant les <m>d_j\cdot N_j(t)</m>.</p>
  </hint>
  <solution>
    <p>
      Il faut essentiellement ajouter une boucle permettant de calculer les polynômes de base <m>N_j(t)</m> à l'intérieur d'une boucle additionnant les <m>d_j\cdot N_j(t)</m>.
      Cela donne :
      <pre>
        # entrées :
        n = 3
        x = [1.0, 2.0, 3.0, 4.0]
        y = [-3.0, 7.0, 0.0, 5.0]
        var('t') # ligne ajoutée
        # instructions :
        diffDiv = [y]
        for j in range(1, n+1):
            nouvelleColonne = []
            for i in range(0, n-j+1):
                nouvelleDiffDiv = (diffDiv[j-1][i+1] - diffDiv[j-1][i]) / (x[i+j] - x[i])
                nouvelleColonne.append(nouvelleDiffDiv)
            diffDiv.append(nouvelleColonne)
        N = diffDiv[0][0] # ligne ajoutée
        for j in range(1, n+1): # ligne ajoutée
            Nj = 1 # ligne ajoutée
            for i in range(0, j): # ligne ajoutée
                Nj = Nj * (t - x[i]) # ligne ajoutée
            N = N + diffDiv[j][0] * Nj # ligne ajoutée
        # sortie :
        print(N) # ligne modifiée
      </pre>
    </p>
  </solution>
</exercise>

</section>

</chapter>
